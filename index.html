<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–§—Ä–∞–Ω—Ü—É–∑—å–∫–∞ –∞–∫–∞–¥–µ–º—ñ—è - –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ –Ω–∞–≤—á–∞–Ω–Ω—è</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .app-container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            text-align: center;
        }
        
        .header h1 {
            color: #4a5568;
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .stats-panel {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #667eea;
        }
        
        .stat-label {
            color: #718096;
            margin-top: 5px;
        }
        
        .achievements {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .achievement-list {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .achievement {
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
        }
        
        .achievement.unlocked {
            background: linear-gradient(45deg, #48bb78, #38a169);
            color: white;
        }
        
        .achievement.locked {
            background: #e2e8f0;
            color: #a0aec0;
        }
        
        .exercise-selector {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }
        
        .exercise-tabs {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .tab {
            padding: 15px 20px;
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            cursor: pointer;
            text-align: center;
            font-weight: bold;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            background: #667eea;
            color: white;
        }
        
        .difficulty-selector {
            text-align: center;
        }
        
        .difficulty-btn {
            padding: 10px 20px;
            margin: 0 5px;
            border: 2px solid #e2e8f0;
            background: white;
            border-radius: 25px;
            cursor: pointer;
        }
        
        .difficulty-btn.active {
            background: #667eea;
            color: white;
        }
        
        .exercise-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        .exercise {
            display: none;
        }
        
        .exercise.active {
            display: block;
        }
        
        .exercise h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 1.8em;
        }
        
        .question {
            margin-bottom: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px solid #e2e8f0;
        }
        
        .question.correct {
            border-color: #48bb78;
            background: #f0fff4;
        }
        
        .question.incorrect {
            border-color: #f56565;
            background: #fff5f5;
        }
        
        input[type="text"] {
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 16px;
            margin: 0 5px;
            width: 150px;
        }
        
        select {
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 10px 15px;
            font-size: 16px;
            margin: 0 5px;
            background: white;
        }
        
        .btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px 5px;
            font-weight: bold;
        }
        
        .btn:hover {
            background: #5a67d8;
        }
        
        .btn-secondary {
            background: #718096;
        }
        
        .btn-success {
            background: #48bb78;
        }
        
        .result {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
            display: none;
            background: #ebf8ff;
        }
        
        .score-panel {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .score-number {
            font-size: 2.5em;
            font-weight: bold;
        }
        
        .word-option {
            display: inline-block;
            padding: 8px 15px;
            margin: 5px;
            background: #e2e8f0;
            border-radius: 20px;
            cursor: pointer;
            user-select: none;
        }
        
        .word-option.used {
            background: #a0aec0;
            cursor: not-allowed;
        }
        
        .sentence-display {
            background: #f7fafc;
            padding: 15px;
            border-radius: 10px;
            min-height: 40px;
            border: 2px dashed #cbd5e0;
            margin: 15px 0;
        }
        
        .hint {
            background: #fef5e7;
            border: 1px solid #f6e05e;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
            color: #744210;
        }
        
        .controls {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e2e8f0;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .notification.success {
            background: linear-gradient(45deg, #48bb78, #38a169);
        }
        
        .notification.warning {
            background: linear-gradient(45deg, #ed8936, #dd6b20);
        }
        
        .review-info {
            background: #fff3cd;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 10px;
            border-left: 4px solid #ffc107;
        }
    </style>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <div class="header">
            <h1>üá´üá∑ –§—Ä–∞–Ω—Ü—É–∑—å–∫–∞ –ê–∫–∞–¥–µ–º—ñ—è</h1>
            <p>–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–µ –≤–∏–≤—á–µ–Ω–Ω—è –¥—ñ—î—Å–ª—ñ–≤ –¥–ª—è –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—è —Ä—ñ–≤–Ω—è B2</p>
        </div>

        <!-- Stats Panel -->
        <div class="stats-panel">
            <div class="stat-card">
                <div class="stat-number" id="totalExercises">0</div>
                <div class="stat-label">–í–ø—Ä–∞–≤ –≤–∏–∫–æ–Ω–∞–Ω–æ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalCorrect">0</div>
                <div class="stat-label">–ü—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="currentStreak">0</div>
                <div class="stat-label">–ü–æ—Ç–æ—á–Ω–∞ —Å–µ—Ä—ñ—è</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="userLevel">1</div>
                <div class="stat-label">–†—ñ–≤–µ–Ω—å</div>
            </div>
        </div>

        <!-- Achievements -->
        <div class="achievements">
            <h3>üèÜ –î–æ—Å—è–≥–Ω–µ–Ω–Ω—è</h3>
            <div class="achievement-list">
                <div class="achievement locked" data-achievement="first-correct">–ü–µ—Ä—à–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å</div>
                <div class="achievement locked" data-achievement="streak-5">–°–µ—Ä—ñ—è –∑ 5 –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö</div>
                <div class="achievement locked" data-achievement="streak-10">–°–µ—Ä—ñ—è –∑ 10 –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö</div>
                <div class="achievement locked" data-achievement="completed-10">10 –≤–ø—Ä–∞–≤ –≤–∏–∫–æ–Ω–∞–Ω–æ</div>
                <div class="achievement locked" data-achievement="perfect-score">–Ü–¥–µ–∞–ª—å–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</div>
            </div>
        </div>

        <!-- Exercise Selector -->
        <div class="exercise-selector">
            <div class="exercise-tabs">
                <div class="tab active" data-exercise="conjugation">üìö –í—ñ–¥–º—ñ–Ω—é–≤–∞–Ω–Ω—è</div>
                <div class="tab" data-exercise="negation">‚ùå –ó–∞–ø–µ—Ä–µ—á–µ–Ω–Ω—è</div>
                <div class="tab" data-exercise="questions">‚ùì –ü–∏—Ç–∞–Ω–Ω—è</div>
                <div class="tab" data-exercise="sentences">üîÑ –°–∫–ª–∞–¥–∞–Ω–Ω—è —Ä–µ—á–µ–Ω—å</div>
                <div class="tab" data-exercise="context">üìñ –ö–æ–Ω—Ç–µ–∫—Å—Ç</div>
                <div class="tab" data-exercise="speed">‚ö° –®–≤–∏–¥–∫—ñ—Å—Ç—å</div>
                <div class="tab" data-exercise="review" id="reviewTab" style="display: none;">üîÑ –ü–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫</div>
            </div>
            
            <div class="difficulty-selector">
                <button class="difficulty-btn active" data-difficulty="beginner">–ü–æ—á–∞—Ç–∫–æ–≤–∏–π</button>
                <button class="difficulty-btn" data-difficulty="intermediate">–°–µ—Ä–µ–¥–Ω—ñ–π</button>
                <button class="difficulty-btn" data-difficulty="advanced">–ü—Ä–æ—Å—É–Ω—É—Ç–∏–π</button>
            </div>
        </div>

        <!-- Score Panel -->
        <div class="score-panel">
            <div class="score-number" id="scoreDisplay">0/0</div>
            <div>–ü–æ—Ç–æ—á–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç</div>
        </div>

        <!-- Exercise Container -->
        <div class="exercise-container">
            <!-- Exercise 1: Conjugation -->
            <div class="exercise active" id="conjugation">
                <h2>üìö –í—ñ–¥–º—ñ–Ω—é–≤–∞–Ω–Ω—è –¥—ñ—î—Å–ª—ñ–≤</h2>
                <div class="hint">üí° –î–æ–ø–æ–≤–Ω—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ—é —Ñ–æ—Ä–º–æ—é –¥—ñ—î—Å–ª–æ–≤–∞</div>
                <div id="conjugationQuestions"></div>
            </div>

            <!-- Exercise 2: Negation -->
            <div class="exercise" id="negation">
                <h2>‚ùå –ó–∞–ø–µ—Ä–µ—á–µ–Ω–Ω—è (ne...pas)</h2>
                <div class="hint">üí° –ü–∞–º'—è—Ç–∞–π—Ç–µ: ne + –¥—ñ—î—Å–ª–æ–≤–æ + pas</div>
                <div id="negationQuestions"></div>
            </div>

            <!-- Exercise 3: Questions -->
            <div class="exercise" id="questions">
                <h2>‚ùì –£—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–∏—Ç–∞–Ω—å</h2>
                <div class="hint">üí° –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —ñ–Ω–≤–µ—Ä—Å—ñ—é, Est-ce que –∞–±–æ —ñ–Ω—Ç–æ–Ω–∞—Ü—ñ—é</div>
                <div id="questionsQuestions"></div>
            </div>

            <!-- Exercise 4: Sentences -->
            <div class="exercise" id="sentences">
                <h2>üîÑ –°–∫–ª–∞–¥–∞–Ω–Ω—è —Ä–µ—á–µ–Ω—å</h2>
                <div class="hint">üí° –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ —Å–ª–æ–≤–∞ —É –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É</div>
                <div id="sentencesQuestions"></div>
            </div>

            <!-- Exercise 5: Context -->
            <div class="exercise" id="context">
                <h2>üìñ –î—ñ—î—Å–ª–æ–≤–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ñ</h2>
                <div class="hint">üí° –í–∏–±–µ—Ä—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω–µ –¥—ñ—î—Å–ª–æ–≤–æ –∑–∞ –∑–º—ñ—Å—Ç–æ–º</div>
                <div id="contextQuestions"></div>
            </div>

            <!-- Exercise 6: Speed -->
            <div class="exercise" id="speed">
                <h2>‚ö° –®–≤–∏–¥–∫—ñ—Å–Ω–∏–π —Ä–∞—É–Ω–¥</h2>
                <div class="hint">üí° –í—ñ–¥–ø–æ–≤—ñ–¥–∞–π—Ç–µ —è–∫–æ–º–æ–≥–∞ —à–≤–∏–¥—à–µ! –ß–∞—Å –æ–±–º–µ–∂–µ–Ω–∏–π</div>
                <div id="speedQuestions"></div>
                <div id="speedTimer" style="text-align: center; font-size: 2em; color: #f56565; margin: 20px 0;"></div>
            </div>

            <!-- Exercise 7: Review -->
            <div class="exercise" id="review">
                <h2>üîÑ –ü–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫</h2>
                <div class="hint">üí° –ü–æ–≤—Ç–æ—Ä—ñ—Ç—å –ø–∏—Ç–∞–Ω–Ω—è, –Ω–∞ —è–∫—ñ –≤–∏ –ø–æ–º–∏–ª—è–ª–∏—Å—è —Ä–∞–Ω—ñ—à–µ</div>
                <div id="reviewQuestions">
                    <div style="text-align: center; padding: 40px;">
                        <p style="font-size: 1.2em; color: #667eea;">üìö –¢—É—Ç –∑'—è–≤–ª—è—Ç—å—Å—è –ø–∏—Ç–∞–Ω–Ω—è, –Ω–∞ —è–∫—ñ –≤–∏ –ø–æ–º–∏–ª—è–ª–∏—Å—è</p>
                        <p style="color: #718096;">–°–ø–æ—á–∞—Ç–∫—É –ø—Ä–æ–π–¥—ñ—Ç—å —ñ–Ω—à—ñ –≤–ø—Ä–∞–≤–∏, —â–æ–± –Ω–∞–∫–æ–ø–∏—á–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è</p>
                    </div>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls">
                <button class="btn" id="checkBtn">–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ</button>
                <button class="btn btn-secondary" id="newQuestionsBtn">–ù–æ–≤—ñ –ø–∏—Ç–∞–Ω–Ω—è</button>
                <button class="btn btn-secondary" id="resetBtn">–°–∫–∏–Ω—É—Ç–∏</button>
                <button class="btn btn-success" id="nextExerciseBtn">–ù–∞—Å—Ç—É–ø–Ω–∞ –≤–ø—Ä–∞–≤–∞</button>
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // Game state
        let gameState = {
            currentExercise: 'conjugation',
            difficulty: 'beginner',
            totalExercises: 0,
            totalCorrect: 0,
            currentStreak: 0,
            userLevel: 1,
            achievements: [],
            currentQuestions: [],
            speedTimer: null,
            speedTimeLeft: 0,
            mistakeQuestions: [],
            sentenceBuilders: {},
            usedQuestions: {}
        };

        // Exercise data
        const exerciseData = {
            conjugation: {
                beginner: [
                    { question: "Je ___ (√™tre) √©tudiant", answer: "suis" },
                    { question: "Tu ___ (avoir) 27 ans", answer: "as" },
                    { question: "Il ___ (aller) √† l'√©cole", answer: "va" },
                    { question: "Nous ___ (faire) du sport", answer: "faisons" },
                    { question: "Vous ___ (pouvoir) parler", answer: "pouvez" },
                    { question: "Ils ___ (vouloir) apprendre", answer: "veulent" },
                    { question: "Elle ___ (parler) fran√ßais", answer: "parle" },
                    { question: "Nous ___ (finir) les devoirs", answer: "finissons" },
                    { question: "Je ___ (avoir) faim", answer: "ai" },
                    { question: "Tu ___ (√™tre) intelligent", answer: "es" },
                    { question: "Elle ___ (aller) au travail", answer: "va" },
                    { question: "Vous ___ (faire) attention", answer: "faites" },
                    { question: "Ils ___ (pouvoir) venir", answer: "peuvent" },
                    { question: "Je ___ (vouloir) dormir", answer: "veux" },
                    { question: "Tu ___ (parler) anglais", answer: "parles" },
                    { question: "Il ___ (finir) son travail", answer: "finit" },
                    { question: "Nous ___ (√™tre) heureux", answer: "sommes" },
                    { question: "Vous ___ (avoir) raison", answer: "avez" },
                    { question: "Elles ___ (aller) en France", answer: "vont" },
                    { question: "Je ___ (faire) mes devoirs", answer: "fais" },
                    { question: "Tu ___ (pouvoir) m'aider", answer: "peux" },
                    { question: "Elle ___ (vouloir) du th√©", answer: "veut" },
                    { question: "Nous ___ (parler) ensemble", answer: "parlons" },
                    { question: "Ils ___ (finir) bient√¥t", answer: "finissent" },
                    { question: "Je ___ (√™tre) m√©decin", answer: "suis" },
                    { question: "Tu ___ (avoir) une s≈ìur", answer: "as" },
                    { question: "Il ___ (aller) chez lui", answer: "va" },
                    { question: "Nous ___ (faire) la cuisine", answer: "faisons" },
                    { question: "Vous ___ (pouvoir) comprendre", answer: "pouvez" },
                    { question: "Elles ___ (vouloir) voyager", answer: "veulent" }
                ],
                intermediate: [
                    { question: "Je ___ (prendre) le m√©tro", answer: "prends" },
                    { question: "Tu ___ (venir) avec nous?", answer: "viens" },
                    { question: "Il ___ (sortir) ce soir", answer: "sort" },
                    { question: "Nous ___ (boire) du caf√©", answer: "buvons" },
                    { question: "Vous ___ (voir) le film?", answer: "voyez" },
                    { question: "Elles ___ (partir) demain", answer: "partent" },
                    { question: "Je ___ (lire) un livre", answer: "lis" },
                    { question: "Tu ___ (√©crire) une lettre", answer: "√©cris" },
                    { question: "Elle ___ (dormir) bien", answer: "dort" },
                    { question: "Nous ___ (offrir) un cadeau", answer: "offrons" },
                    { question: "Vous ___ (mentir) souvent", answer: "mentez" },
                    { question: "Ils ___ (courir) vite", answer: "courent" },
                    { question: "Je ___ (mettre) ma veste", answer: "mets" },
                    { question: "Tu ___ (battre) le record", answer: "bats" },
                    { question: "Il ___ (conna√Ætre) Paris", answer: "conna√Æt" },
                    { question: "Nous ___ (suivre) le cours", answer: "suivons" },
                    { question: "Vous ___ (vivre) en France", answer: "vivez" },
                    { question: "Elles ___ (rire) beaucoup", answer: "rient" },
                    { question: "Je ___ (comprendre) tout", answer: "comprends" },
                    { question: "Tu ___ (attendre) l'autobus", answer: "attends" },
                    { question: "Il ___ (descendre) les escaliers", answer: "descend" },
                    { question: "Nous ___ (r√©pondre) aux questions", answer: "r√©pondons" },
                    { question: "Vous ___ (vendre) votre maison", answer: "vendez" },
                    { question: "Ils ___ (entendre) du bruit", answer: "entendent" },
                    { question: "Je ___ (perdre) mes cl√©s", answer: "perds" },
                    { question: "Tu ___ (rendre) visite", answer: "rends" },
                    { question: "Elle ___ (tendre) la main", answer: "tend" },
                    { question: "Nous ___ (d√©fendre) nos id√©es", answer: "d√©fendons" },
                    { question: "Vous ___ (apprendre) le fran√ßais", answer: "apprenez" },
                    { question: "Ils ___ (surprendre) tout le monde", answer: "surprennent" }
                ],
                advanced: [
                    { question: "Je ___ (s'asseoir) ici", answer: "m'assieds" },
                    { question: "Tu ___ (conduire) bien", answer: "conduis" },
                    { question: "Il ___ (r√©soudre) le probl√®me", answer: "r√©sout" },
                    { question: "Nous ___ (recevoir) des lettres", answer: "recevons" },
                    { question: "Vous ___ (apercevoir) la montagne", answer: "apercevez" },
                    { question: "Ils ___ (d√©cevoir) leurs parents", answer: "d√©√ßoivent" },
                    { question: "Je ___ (craindre) le froid", answer: "crains" },
                    { question: "Tu ___ (peindre) un tableau", answer: "peins" },
                    { question: "Elle ___ (joindre) ses mains", answer: "joint" },
                    { question: "Nous ___ (coudre) des v√™tements", answer: "cousons" },
                    { question: "Vous ___ (moudre) le caf√©", answer: "moulez" },
                    { question: "Ils ___ (absoudre) le p√©ch√©", answer: "absolvent" },
                    { question: "Je ___ (se taire) maintenant", answer: "me tais" },
                    { question: "Tu ___ (extraire) le jus", answer: "extrais" },
                    { question: "Il ___ (construire) une maison", answer: "construit" },
                    { question: "Nous ___ (traduire) le texte", answer: "traduisons" },
                    { question: "Vous ___ (instruire) les √©tudiants", answer: "instruisez" },
                    { question: "Elles ___ (d√©truire) les preuves", answer: "d√©truisent" },
                    { question: "Je ___ (cuire) le d√Æner", answer: "cuis" },
                    { question: "Tu ___ (nuire) √† sa r√©putation", answer: "nuis" },
                    { question: "Il ___ (luire) dans l'obscurit√©", answer: "luit" },
                    { question: "Nous ___ (s'enfuir) rapidement", answer: "nous enfuyons" },
                    { question: "Vous ___ (bouillir) l'eau", answer: "faites bouillir" },
                    { question: "Ils ___ (accueillir) les invit√©s", answer: "accueillent" },
                    { question: "Je ___ (cueillir) des fleurs", answer: "cueille" },
                    { question: "Tu ___ (recueillir) des informations", answer: "recueilles" },
                    { question: "Elle ___ (assaillir) l'ennemi", answer: "assaille" },
                    { question: "Nous ___ (tressaillir) de peur", answer: "tressaillons" },
                    { question: "Vous ___ (d√©faillir) sous la pression", answer: "d√©faillez" },
                    { question: "Ils ___ (saillir) du mur", answer: "saillent" }
                ]
            },
            negation: {
                beginner: [
                    { question: "Je ___ professeur", answer: "ne suis pas" },
                    { question: "Tu ___ de voiture", answer: "n'as pas" },
                    { question: "Il ___ au cin√©ma", answer: "ne va pas" },
                    { question: "Nous ___ de sport", answer: "ne faisons pas" },
                    { question: "Vous ___ fran√ßais", answer: "ne parlez pas" },
                    { question: "Elles ___ fatigu√©es", answer: "ne sont pas" },
                    { question: "Je ___ d'argent", answer: "n'ai pas" },
                    { question: "Tu ___ en ville", answer: "ne vas pas" },
                    { question: "Il ___ ses devoirs", answer: "ne fait pas" },
                    { question: "Nous ___ vous aider", answer: "ne pouvons pas" },
                    { question: "Vous ___ partir", answer: "ne voulez pas" },
                    { question: "Ils ___ bien", answer: "ne parlent pas" },
                    { question: "Elle ___ son travail", answer: "ne finit pas" },
                    { question: "Je ___ content", answer: "ne suis pas" },
                    { question: "Tu ___ le temps", answer: "n'as pas" },
                    { question: "Il ___ √† la maison", answer: "ne va pas" },
                    { question: "Nous ___ de musique", answer: "ne faisons pas" },
                    { question: "Vous ___ danser", answer: "ne pouvez pas" },
                    { question: "Elles ___ sortir", answer: "ne veulent pas" },
                    { question: "Je ___ anglais", answer: "ne parle pas" },
                    { question: "Tu ___ tes √©tudes", answer: "ne finis pas" },
                    { question: "Il ___ malade", answer: "n'est pas" },
                    { question: "Nous ___ d'enfants", answer: "n'avons pas" },
                    { question: "Vous ___ au bureau", answer: "n'allez pas" },
                    { question: "Ils ___ la vaisselle", answer: "ne font pas" },
                    { question: "Elle ___ conduire", answer: "ne peut pas" },
                    { question: "Je ___ voyager", answer: "ne veux pas" },
                    { question: "Tu ___ espagnol", answer: "ne parles pas" },
                    { question: "Il ___ √† l'heure", answer: "ne finit pas" },
                    { question: "Nous ___ riches", answer: "ne sommes pas" }
                ],
                intermediate: [
                    { question: "Elle ___ le fran√ßais", answer: "ne parle pas" },
                    { question: "Vous ___ venir", answer: "ne pouvez pas" },
                    { question: "Ils ___ partir", answer: "ne veulent pas" },
                    { question: "Je ___ le livre", answer: "ne lis pas" },
                    { question: "Tu ___ bien", answer: "ne dors pas" },
                    { question: "Il ___ de caf√©", answer: "ne boit pas" },
                    { question: "Nous ___ le film", answer: "ne voyons pas" },
                    { question: "Vous ___ t√¥t", answer: "ne partez pas" },
                    { question: "Elles ___ vite", answer: "ne courent pas" },
                    { question: "Je ___ ma veste", answer: "ne mets pas" },
                    { question: "Tu ___ la lettre", answer: "n'√©cris pas" },
                    { question: "Il ___ le journal", answer: "ne lit pas" },
                    { question: "Nous ___ de cadeaux", answer: "n'offrons pas" },
                    { question: "Vous ___ souvent", answer: "ne mentez pas" },
                    { question: "Ils ___ le record", answer: "ne battent pas" },
                    { question: "Elle ___ la ville", answer: "ne conna√Æt pas" },
                    { question: "Je ___ le cours", answer: "ne suis pas" },
                    { question: "Tu ___ ici", answer: "ne vis pas" },
                    { question: "Il ___ jamais", answer: "ne rit pas" },
                    { question: "Nous ___ les r√®gles", answer: "ne comprenons pas" },
                    { question: "Vous ___ l'autobus", answer: "n'attendez pas" },
                    { question: "Elles ___ les escaliers", answer: "ne descendent pas" },
                    { question: "Je ___ aux questions", answer: "ne r√©ponds pas" },
                    { question: "Tu ___ ta maison", answer: "ne vends pas" },
                    { question: "Il ___ du bruit", answer: "n'entend pas" },
                    { question: "Nous ___ nos cl√©s", answer: "ne perdons pas" },
                    { question: "Vous ___ visite", answer: "ne rendez pas" },
                    { question: "Ils ___ la main", answer: "ne tendent pas" },
                    { question: "Elle ___ ses id√©es", answer: "ne d√©fend pas" },
                    { question: "Je ___ le fran√ßais", answer: "n'apprends pas" }
                ],
                advanced: [
                    { question: "Je ___ rien", answer: "ne fais rien" },
                    { question: "Il ___ personne", answer: "ne voit personne" },
                    { question: "Nous ___ nulle part", answer: "n'allons nulle part" },
                    { question: "Vous ___ jamais", answer: "ne venez jamais" },
                    { question: "Elles ___ aucun livre", answer: "ne lisent aucun livre" },
                    { question: "Je ___ plus", answer: "ne mange plus" },
                    { question: "Tu ___ ni fran√ßais ni anglais", answer: "ne parles ni fran√ßais ni anglais" },
                    { question: "Il ___ que travailler", answer: "ne fait que travailler" },
                    { question: "Nous ___ gu√®re", answer: "ne sortons gu√®re" },
                    { question: "Vous ___ nullement", answer: "n'√™tes nullement" },
                    { question: "Ils ___ point", answer: "ne comprennent point" },
                    { question: "Elle ___ aucunement", answer: "ne s'int√©resse aucunement" },
                    { question: "Je ___ pas encore", answer: "ne suis pas encore" },
                    { question: "Tu ___ toujours pas", answer: "n'as toujours pas" },
                    { question: "Il ___ non plus", answer: "ne vient non plus" },
                    { question: "Nous ___ m√™me pas", answer: "ne savons m√™me pas" },
                    { question: "Vous ___ absolument pas", answer: "ne comprenez absolument pas" },
                    { question: "Elles ___ du tout", answer: "n'aiment du tout" },
                    { question: "Je ___ pas du tout", answer: "ne suis pas du tout" },
                    { question: "Tu ___ plus jamais", answer: "ne viens plus jamais" },
                    { question: "Il ___ pas encore", answer: "n'est pas encore" },
                    { question: "Nous ___ plus rien", answer: "ne faisons plus rien" },
                    { question: "Vous ___ jamais rien", answer: "ne dites jamais rien" },
                    { question: "Ils ___ plus personne", answer: "ne voient plus personne" },
                    { question: "Elle ___ jamais personne", answer: "n'invite jamais personne" },
                    { question: "Je ___ plus nulle part", answer: "ne vais plus nulle part" },
                    { question: "Tu ___ jamais nulle part", answer: "ne sors jamais nulle part" },
                    { question: "Il ___ pas non plus", answer: "ne comprend pas non plus" },
                    { question: "Nous ___ plus gu√®re", answer: "ne sortons plus gu√®re" },
                    { question: "Vous ___ pas encore", answer: "n'√™tes pas encore" }
                ]
            },
            questions: {
                beginner: [
                    { question: "___ professeur?", answer: "√™tes-vous" },
                    { question: "___ ce soir?", answer: "qu'est-ce que tu fais" },
                    { question: "___ en vacances?", answer: "o√π allez-vous" },
                    { question: "___ fran√ßais?", answer: "parlez-vous" },
                    { question: "___ faim?", answer: "as-tu" },
                    { question: "___ √† l'√©cole?", answer: "va-t-il" },
                    { question: "___ du sport?", answer: "faites-vous" },
                    { question: "___ venir?", answer: "peuvent-ils" },
                    { question: "___ partir?", answer: "veux-tu" },
                    { question: "___ bien?", answer: "parle-t-elle" },
                    { question: "___ √©tudiant?", answer: "es-tu" },
                    { question: "___ une voiture?", answer: "avez-vous" },
                    { question: "___ au cin√©ma?", answer: "allons-nous" },
                    { question: "___ tes devoirs?", answer: "fais-tu" },
                    { question: "___ nous aider?", answer: "pouvez-vous" },
                    { question: "___ du caf√©?", answer: "veulent-ils" },
                    { question: "___ italien?", answer: "parles-tu" },
                    { question: "___ le travail?", answer: "finit-elle" },
                    { question: "___ m√©decin?", answer: "√™tes-vous" },
                    { question: "___ des fr√®res?", answer: "a-t-il" },
                    { question: "___ √† la maison?", answer: "reste-t-elle" },
                    { question: "___ de la musique?", answer: "√©coutez-vous" },
                    { question: "___ danser?", answer: "sais-tu" },
                    { question: "___ en France?", answer: "habitent-ils" },
                    { question: "___ content?", answer: "est-il" },
                    { question: "___ des amis?", answer: "as-tu" },
                    { question: "___ tard?", answer: "rentrez-vous" },
                    { question: "___ de l'eau?", answer: "boit-elle" },
                    { question: "___ ensemble?", answer: "travaillons-nous" },
                    { question: "___ beau temps?", answer: "fait-il" }
                ],
                intermediate: [
                    { question: "___ parler fran√ßais?", answer: "est-ce que tu peux" },
                    { question: "___ ce livre?", answer: "aimes-tu" },
                    { question: "___ demain?", answer: "que fais-tu" },
                    { question: "___ ce film?", answer: "avez-vous vu" },
                    { question: "___ si tard?", answer: "pourquoi pars-tu" },
                    { question: "___ le m√©tro?", answer: "prend-il" },
                    { question: "___ du caf√©?", answer: "buvez-vous" },
                    { question: "___ bien?", answer: "dors-tu" },
                    { question: "___ une lettre?", answer: "√©crit-elle" },
                    { question: "___ des livres?", answer: "lisez-vous" },
                    { question: "___ de la musique?", answer: "entends-tu" },
                    { question: "___ vite?", answer: "court-il" },
                    { question: "___ tes cl√©s?", answer: "cherches-tu" },
                    { question: "___ la v√©rit√©?", answer: "dit-elle" },
                    { question: "___ en France?", answer: "vivez-vous" },
                    { question: "___ le probl√®me?", answer: "comprend-il" },
                    { question: "___ l'autobus?", answer: "attends-tu" },
                    { question: "___ les escaliers?", answer: "descend-elle" },
                    { question: "___ aux questions?", answer: "r√©pondez-vous" },
                    { question: "___ votre maison?", answer: "vendez-vous" },
                    { question: "___ du bruit?", answer: "entendent-ils" },
                    { question: "___ vos cl√©s?", answer: "perdez-vous" },
                    { question: "___ visite?", answer: "rend-il" },
                    { question: "___ la main?", answer: "tend-elle" },
                    { question: "___ vos id√©es?", answer: "d√©fendez-vous" },
                    { question: "___ le fran√ßais?", answer: "apprend-il" },
                    { question: "___ tout le monde?", answer: "surprend-elle" },
                    { question: "___ des cadeaux?", answer: "offrent-ils" },
                    { question: "___ souvent?", answer: "ment-il" },
                    { question: "___ le record?", answer: "bat-elle" }
                ],
                advanced: [
                    { question: "___ de temps √©tudiez-vous?", answer: "combien" },
                    { question: "___ pensez-vous de ce film?", answer: "que" },
                    { question: "___ √™tes-vous venu?", answer: "comment" },
                    { question: "___ avez-vous choisi?", answer: "pourquoi" },
                    { question: "___ habitez-vous?", answer: "o√π" },
                    { question: "___ partez-vous?", answer: "quand" },
                    { question: "___ co√ªte ce livre?", answer: "combien" },
                    { question: "___ appelez-vous?", answer: "comment vous" },
                    { question: "___ √¢ge avez-vous?", answer: "quel" },
                    { question: "___ heure est-il?", answer: "quelle" },
                    { question: "___ de personnes viendront?", answer: "combien" },
                    { question: "___ langue pr√©f√©rez-vous?", answer: "quelle" },
                    { question: "___ couleur aimez-vous?", answer: "quelle" },
                    { question: "___ temps fait-il?", answer: "quel" },
                    { question: "___ saison pr√©f√©rez-vous?", answer: "quelle" },
                    { question: "___ jour sommes-nous?", answer: "quel" },
                    { question: "___ ann√©e √™tes-vous n√©?", answer: "en quelle" },
                    { question: "___ mois partons-nous?", answer: "en quel" },
                    { question: "___ ville habitez-vous?", answer: "dans quelle" },
                    { question: "___ pays voyagez-vous?", answer: "dans quel" },
                    { question: "___ universit√© √©tudiez-vous?", answer: "dans quelle" },
                    { question: "___ entreprise travaillez-vous?", answer: "dans quelle" },
                    { question: "___ quartier habitez-vous?", answer: "dans quel" },
                    { question: "___ direction allez-vous?", answer: "dans quelle" },
                    { question: "___ sens comprenez-vous?", answer: "dans quel" },
                    { question: "___ mesure √™tes-vous d'accord?", answer: "dans quelle" },
                    { question: "___ but faites-vous cela?", answer: "dans quel" },
                    { question: "___ intention agissez-vous?", answer: "dans quelle" },
                    { question: "___ esprit travaillez-vous?", answer: "dans quel" },
                    { question: "___ perspective envisagez-vous?", answer: "dans quelle" }
                ]
            },
            sentences: {
                beginner: [
                    { 
                        instruction: "–Ø —Ö–æ—á—É –≤–∏–≤—á–∏—Ç–∏ —Ñ—Ä–∞–Ω—Ü—É–∑—å–∫—É", 
                        answer: "je veux apprendre le fran√ßais",
                        words: ["je", "veux", "apprendre", "le", "fran√ßais", "parler", "bien", "maintenant"]
                    },
                    { 
                        instruction: "–ú–∏ –º–æ–∂–µ–º–æ –≥–æ–≤–æ—Ä–∏—Ç–∏ —Ñ—Ä–∞–Ω—Ü—É–∑—å–∫–æ—é", 
                        answer: "nous pouvons parler fran√ßais",
                        words: ["nous", "pouvons", "parler", "fran√ßais", "bien", "maintenant", "ici", "toujours"]
                    }
                ],
                intermediate: [
                    { 
                        instruction: "–ú–∏ —á–∏—Ç–∞—î–º–æ —Ü—ñ–∫–∞–≤—ñ –∫–Ω–∏–≥–∏", 
                        answer: "nous lisons des livres int√©ressants",
                        words: ["nous", "lisons", "des", "livres", "int√©ressants", "souvent", "beaucoup", "ensemble"]
                    }
                ],
                advanced: [
                    { 
                        instruction: "–Ø–∫–±–∏ —è –º—ñ–≥, —è –± –ø–æ–¥–æ—Ä–æ–∂—É–≤–∞–≤", 
                        answer: "si je pouvais je voyagerais",
                        words: ["si", "je", "pouvais", "voyagerais", "dans", "le", "monde", "serais", "ferais"]
                    }
                ]
            },
            context: {
                beginner: [
                    { question: "Marie ___ tr√®s intelligente", options: ["suis", "est", "√™tes"], answer: "est", context: "(–ú–∞—Ä—ñ –¥—É–∂–µ —Ä–æ–∑—É–º–Ω–∞)" },
                    { question: "Nous ___ beaucoup de travail", options: ["avons", "sommes", "faisons"], answer: "avons", context: "(–£ –Ω–∞—Å –±–∞–≥–∞—Ç–æ —Ä–æ–±–æ—Ç–∏)" },
                    { question: "Les √©tudiants ___ √† l'universit√©", options: ["vont", "font", "peuvent"], answer: "vont", context: "(–°—Ç—É–¥–µ–Ω—Ç–∏ –π–¥—É—Ç—å –¥–æ —É–Ω—ñ–≤–µ—Ä—Å–∏—Ç–µ—Ç—É)" },
                    { question: "Pierre ___ du caf√©", options: ["veut", "boit", "fait"], answer: "boit", context: "(–ü'—î—Ä –ø'—î –∫–∞–≤—É)" },
                    { question: "Elle ___ bien le piano", options: ["joue", "fait", "va"], answer: "joue", context: "(–í–æ–Ω–∞ –¥–æ–±—Ä–µ –≥—Ä–∞—î –Ω–∞ –ø—ñ–∞–Ω—ñ–Ω–æ)" },
                    { question: "Je ___ fatigu√© aujourd'hui", options: ["suis", "ai", "fais"], answer: "suis", context: "(–Ø –≤—Ç–æ–º–∏–≤—Å—è —Å—å–æ–≥–æ–¥–Ω—ñ)" },
                    { question: "Tu ___ une belle voix", options: ["es", "as", "fais"], answer: "as", context: "(–£ —Ç–µ–±–µ –∫—Ä–∞—Å–∏–≤–∏–π –≥–æ–ª–æ—Å)" },
                    { question: "Il ___ au magasin", options: ["va", "fait", "a"], answer: "va", context: "(–í—ñ–Ω –π–¥–µ –¥–æ –º–∞–≥–∞–∑–∏–Ω—É)" },
                    { question: "Nous ___ nos devoirs", options: ["faisons", "sommes", "avons"], answer: "faisons", context: "(–ú–∏ —Ä–æ–±–∏–º–æ –¥–æ–º–∞—à–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è)" },
                    { question: "Vous ___ parler chinois", options: ["pouvez", "√™tes", "allez"], answer: "pouvez", context: "(–í–∏ –º–æ–∂–µ—Ç–µ –≥–æ–≤–æ—Ä–∏—Ç–∏ –∫–∏—Ç–∞–π—Å—å–∫–æ—é)" },
                    { question: "Ils ___ voyager en √©t√©", options: ["veulent", "sont", "ont"], answer: "veulent", context: "(–í–æ–Ω–∏ —Ö–æ—á—É—Ç—å –ø–æ–¥–æ—Ä–æ–∂—É–≤–∞—Ç–∏ –≤–ª—ñ—Ç–∫—É)" },
                    { question: "Elle ___ tr√®s bien fran√ßais", options: ["parle", "est", "a"], answer: "parle", context: "(–í–æ–Ω–∞ –¥—É–∂–µ –¥–æ–±—Ä–µ –≥–æ–≤–æ—Ä–∏—Ç—å —Ñ—Ä–∞–Ω—Ü—É–∑—å–∫–æ—é)" },
                    { question: "Je ___ mes √©tudes", options: ["finis", "suis", "ai"], answer: "finis", context: "(–Ø –∑–∞–∫—ñ–Ω—á—É—é –Ω–∞–≤—á–∞–Ω–Ω—è)" },
                    { question: "Tu ___ toujours en retard", options: ["es", "as", "vas"], answer: "es", context: "(–¢–∏ –∑–∞–≤–∂–¥–∏ —Å–ø—ñ–∑–Ω—é—î—à—Å—è)" },
                    { question: "Il ___ beaucoup d'amis", options: ["a", "est", "va"], answer: "a", context: "(–£ –Ω—å–æ–≥–æ –±–∞–≥–∞—Ç–æ –¥—Ä—É–∑—ñ–≤)" },
                    { question: "Nous ___ en France", options: ["allons", "sommes", "faisons"], answer: "allons", context: "(–ú–∏ —ó–¥–µ–º–æ –¥–æ –§—Ä–∞–Ω—Ü—ñ—ó)" },
                    { question: "Vous ___ du sport", options: ["faites", "√™tes", "avez"], answer: "faites", context: "(–í–∏ –∑–∞–π–º–∞—î—Ç–µ—Å—è —Å–ø–æ—Ä—Ç–æ–º)" },
                    { question: "Elles ___ nager", options: ["peuvent", "sont", "ont"], answer: "peuvent", context: "(–í–æ–Ω–∏ –º–æ–∂—É—Ç—å –ø–ª–∞–≤–∞—Ç–∏)" },
                    { question: "Je ___ apprendre l'italien", options: ["veux", "suis", "ai"], answer: "veux", context: "(–Ø —Ö–æ—á—É –≤–∏–≤—á–∏—Ç–∏ —ñ—Ç–∞–ª—ñ–π—Å—å–∫—É)" },
                    { question: "Tu ___ tr√®s vite", options: ["parles", "es", "as"], answer: "parles", context: "(–¢–∏ –≥–æ–≤–æ—Ä–∏—à –¥—É–∂–µ —à–≤–∏–¥–∫–æ)" },
                    { question: "Il ___ de la guitare", options: ["joue", "fait", "va"], answer: "joue", context: "(–í—ñ–Ω –≥—Ä–∞—î –Ω–∞ –≥—ñ—Ç–∞—Ä—ñ)" },
                    { question: "Nous ___ contents", options: ["sommes", "avons", "faisons"], answer: "sommes", context: "(–ú–∏ –∑–∞–¥–æ–≤–æ–ª–µ–Ω—ñ)" },
                    { question: "Vous ___ de la chance", options: ["avez", "√™tes", "allez"], answer: "avez", context: "(–í–∞–º –ø–æ—â–∞—Å—Ç–∏–ª–æ)" },
                    { question: "Ils ___ au restaurant", options: ["vont", "font", "sont"], answer: "vont", context: "(–í–æ–Ω–∏ –π–¥—É—Ç—å –¥–æ —Ä–µ—Å—Ç–æ—Ä–∞–Ω—É)" },
                    { question: "Elle ___ cuisiner", options: ["peut", "est", "a"], answer: "peut", context: "(–í–æ–Ω–∞ –º–æ–∂–µ –≥–æ—Ç—É–≤–∞—Ç–∏)" },
                    { question: "Je ___ me marier", options: ["veux", "suis", "ai"], answer: "veux", context: "(–Ø —Ö–æ—á—É –æ–¥—Ä—É–∂–∏—Ç–∏—Å—è)" },
                    { question: "Tu ___ italien", options: ["parles", "es", "as"], answer: "parles", context: "(–¢–∏ –≥–æ–≤–æ—Ä–∏—à —ñ—Ç–∞–ª—ñ–π—Å—å–∫–æ—é)" },
                    { question: "Il ___ tard", options: ["finit", "est", "a"], answer: "finit", context: "(–í—ñ–Ω –∑–∞–∫—ñ–Ω—á—É—î –ø—ñ–∑–Ω–æ)" },
                    { question: "Nous ___ m√©decins", options: ["sommes", "avons", "faisons"], answer: "sommes", context: "(–ú–∏ –ª—ñ–∫–∞—Ä—ñ)" },
                    { question: "Vous ___ raison", options: ["avez", "√™tes", "allez"], answer: "avez", context: "(–í–∏ –º–∞—î—Ç–µ —Ä–∞—Ü—ñ—é)" }
                ],
                intermediate: [
                    { question: "Il ___ ses erreurs", options: ["reconna√Æt", "fait", "va"], answer: "reconna√Æt", context: "(–í—ñ–Ω –≤–∏–∑–Ω–∞—î —Å–≤–æ—ó –ø–æ–º–∏–ª–∫–∏)" },
                    { question: "Nous ___ ce probl√®me", options: ["r√©solvons", "faisons", "avons"], answer: "r√©solvons", context: "(–ú–∏ –≤–∏—Ä—ñ—à—É—î–º–æ —Ü—é –ø—Ä–æ–±–ª–µ–º—É)" },
                    { question: "Elle ___ un livre passionnant", options: ["lit", "fait", "va"], answer: "lit", context: "(–í–æ–Ω–∞ —á–∏—Ç–∞—î –∑–∞—Ö–æ–ø–ª—é—é—á—É –∫–Ω–∏–≥—É)" },
                    { question: "Tu ___ une lettre", options: ["√©cris", "fais", "vas"], answer: "√©cris", context: "(–¢–∏ –ø–∏—à–µ—à –ª–∏—Å—Ç–∞)" },
                    { question: "Il ___ bien la nuit", options: ["dort", "fait", "va"], answer: "dort", context: "(–í—ñ–Ω –¥–æ–±—Ä–µ —Å–ø–∏—Ç—å –≤–Ω–æ—á—ñ)" },
                    { question: "Nous ___ des cadeaux", options: ["offrons", "faisons", "allons"], answer: "offrons", context: "(–ú–∏ –¥–∞—Ä—É–≤–∞–ª–∏ –ø–æ–¥–∞—Ä—É–Ω–∫–∏)" },
                    { question: "Vous ___ souvent", options: ["mentez", "faites", "allez"], answer: "mentez", context: "(–í–∏ —á–∞—Å—Ç–æ –±—Ä–µ—à–µ—Ç–µ)" },
                    { question: "Ils ___ tr√®s vite", options: ["courent", "font", "vont"], answer: "courent", context: "(–í–æ–Ω–∏ –±—ñ–∂–∞—Ç—å –¥—É–∂–µ —à–≤–∏–¥–∫–æ)" },
                    { question: "Je ___ ma veste", options: ["mets", "fais", "vais"], answer: "mets", context: "(–Ø –æ–¥—è–≥–∞—é –∫—É—Ä—Ç–∫—É)" },
                    { question: "Tu ___ le record", options: ["bats", "fais", "vas"], answer: "bats", context: "(–¢–∏ –±'—î—à —Ä–µ–∫–æ—Ä–¥)" },
                    { question: "Elle ___ Paris", options: ["conna√Æt", "fait", "va"], answer: "conna√Æt", context: "(–í–æ–Ω–∞ –∑–Ω–∞—î –ü–∞—Ä–∏–∂)" },
                    { question: "Nous ___ le cours", options: ["suivons", "faisons", "allons"], answer: "suivons", context: "(–ú–∏ –≤—ñ–¥–≤—ñ–¥—É—î–º–æ –∫—É—Ä—Å)" },
                    { question: "Vous ___ en France", options: ["vivez", "faites", "allez"], answer: "vivez", context: "(–í–∏ –∂–∏–≤–µ—Ç–µ —É –§—Ä–∞–Ω—Ü—ñ—ó)" },
                    { question: "Ils ___ beaucoup", options: ["rient", "font", "vont"], answer: "rient", context: "(–í–æ–Ω–∏ –±–∞–≥–∞—Ç–æ —Å–º—ñ—é—Ç—å—Å—è)" },
                    { question: "Je ___ tout", options: ["comprends", "fais", "vais"], answer: "comprends", context: "(–Ø –≤—Å–µ —Ä–æ–∑—É–º—ñ—é)" },
                    { question: "Tu ___ l'autobus", options: ["attends", "fais", "vas"], answer: "attends", context: "(–¢–∏ —á–µ–∫–∞—î—à –∞–≤—Ç–æ–±—É—Å)" },
                    { question: "Il ___ les escaliers", options: ["descend", "fait", "va"], answer: "descend", context: "(–í—ñ–Ω —Å–ø—É—Å–∫–∞—î—Ç—å—Å—è —Å—Ö–æ–¥–∞–º–∏)" },
                    { question: "Nous ___ aux questions", options: ["r√©pondons", "faisons", "allons"], answer: "r√©pondons", context: "(–ú–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î–º–æ –Ω–∞ –ø–∏—Ç–∞–Ω–Ω—è)" },
                    { question: "Vous ___ votre maison", options: ["vendez", "faites", "allez"], answer: "vendez", context: "(–í–∏ –ø—Ä–æ–¥–∞—î—Ç–µ —Å–≤—ñ–π –±—É–¥–∏–Ω–æ–∫)" },
                    { question: "Ils ___ du bruit", options: ["entendent", "font", "vont"], answer: "entendent", context: "(–í–æ–Ω–∏ —á—É—é—Ç—å —à—É–º)" },
                    { question: "Elle ___ ses cl√©s", options: ["perd", "fait", "va"], answer: "perd", context: "(–í–æ–Ω–∞ –≥—É–±–∏—Ç—å –∫–ª—é—á—ñ)" },
                    { question: "Je ___ visite", options: ["rends", "fais", "vais"], answer: "rends", context: "(–Ø –Ω–∞–Ω–æ—à—É –≤—ñ–∑–∏—Ç)" },
                    { question: "Tu ___ la main", options: ["tends", "fais", "vas"], answer: "tends", context: "(–¢–∏ –ø—Ä–æ—Å—Ç—è–≥–∞—î—à —Ä—É–∫—É)" },
                    { question: "Il ___ ses id√©es", options: ["d√©fend", "fait", "va"], answer: "d√©fend", context: "(–í—ñ–Ω –∑–∞—Ö–∏—â–∞—î —Å–≤–æ—ó —ñ–¥–µ—ó)" },
                    { question: "Nous ___ le fran√ßais", options: ["apprenons", "faisons", "allons"], answer: "apprenons", context: "(–ú–∏ –≤–∏–≤—á–∞—î–º–æ —Ñ—Ä–∞–Ω—Ü—É–∑—å–∫—É)" },
                    { question: "Vous ___ tout le monde", options: ["surprenez", "faites", "allez"], answer: "surprenez", context: "(–í–∏ –¥–∏–≤—É—î—Ç–µ –≤—Å—ñ—Ö)" },
                    { question: "Elles ___ en voyage", options: ["partent", "font", "vont"], answer: "partent", context: "(–í–æ–Ω–∏ –≤—ñ–¥'—ó–∂–¥–∂–∞—é—Ç—å —É –ø–æ–¥–æ—Ä–æ–∂)" },
                    { question: "Je ___ du th√©", options: ["bois", "fais", "vais"], answer: "bois", context: "(–Ø –ø'—é —á–∞–π)" },
                    { question: "Tu ___ le film", options: ["vois", "fais", "vas"], answer: "vois", context: "(–¢–∏ –¥–∏–≤–∏—à—Å—è —Ñ—ñ–ª—å–º)" },
                    { question: "Elle ___ ce soir", options: ["sort", "fait", "va"], answer: "sort", context: "(–í–æ–Ω–∞ –≤–∏—Ö–æ–¥–∏—Ç—å —Å—å–æ–≥–æ–¥–Ω—ñ –≤–≤–µ—á–µ—Ä—ñ)" }
                ],
                advanced: [
                    { question: "Elle ___ des conclusions", options: ["tire", "fait", "prend"], answer: "tire", context: "(–í–æ–Ω–∞ —Ä–æ–±–∏—Ç—å –≤–∏—Å–Ω–æ–≤–∫–∏)" },
                    { question: "Il ___ ses responsabilit√©s", options: ["assume", "fait", "prend"], answer: "assume", context: "(–í—ñ–Ω –±–µ—Ä–µ –Ω–∞ —Å–µ–±–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω—ñ—Å—Ç—å)" },
                    { question: "Nous ___ des obstacles", options: ["surmontons", "faisons", "prenons"], answer: "surmontons", context: "(–ú–∏ –¥–æ–ª–∞—î–º–æ –ø–µ—Ä–µ—à–∫–æ–¥–∏)" },
                    { question: "Vous ___ vos promesses", options: ["tenez", "faites", "prenez"], answer: "tenez", context: "(–í–∏ –¥–æ—Ç—Ä–∏–º—É—î—Ç–µ—Å—è —Å–≤–æ—ó—Ö –æ–±—ñ—Ü—è–Ω–æ–∫)" },
                    { question: "Ils ___ leurs objectifs", options: ["atteignent", "font", "prennent"], answer: "atteignent", context: "(–í–æ–Ω–∏ –¥–æ—Å—è–≥–∞—é—Ç—å —Å–≤–æ—ó—Ö —Ü—ñ–ª–µ–π)" },
                    { question: "Je ___ la v√©rit√©", options: ["d√©couvre", "fais", "prends"], answer: "d√©couvre", context: "(–Ø –≤—ñ–¥–∫—Ä–∏–≤–∞—é –ø—Ä–∞–≤–¥—É)" },
                    { question: "Tu ___ tes erreurs", options: ["corriges", "fais", "prends"], answer: "corriges", context: "(–¢–∏ –≤–∏–ø—Ä–∞–≤–ª—è—î—à —Å–≤–æ—ó –ø–æ–º–∏–ª–∫–∏)" },
                    { question: "Elle ___ une d√©cision", options: ["prend", "fait", "tient"], answer: "prend", context: "(–í–æ–Ω–∞ –ø—Ä–∏–π–º–∞—î —Ä—ñ—à–µ–Ω–Ω—è)" },
                    { question: "Nous ___ nos forces", options: ["unissons", "faisons", "prenons"], answer: "unissons", context: "(–ú–∏ –æ–±'—î–¥–Ω—É—î–º–æ –Ω–∞—à—ñ —Å–∏–ª–∏)" },
                    { question: "Vous ___ l'avenir", options: ["pr√©disez", "faites", "prenez"], answer: "pr√©disez", context: "(–í–∏ –ø–µ—Ä–µ–¥–±–∞—á–∞—î—Ç–µ –º–∞–π–±—É—Ç–Ω—î)" },
                    { question: "Ils ___ le probl√®me", options: ["r√©solvent", "font", "prennent"], answer: "r√©solvent", context: "(–í–æ–Ω–∏ –≤–∏—Ä—ñ—à—É—é—Ç—å –ø—Ä–æ–±–ª–µ–º—É)" },
                    { question: "Je ___ mes principes", options: ["maintiens", "fais", "prends"], answer: "maintiens", context: "(–Ø –¥–æ—Ç—Ä–∏–º—É—é—Å—è —Å–≤–æ—ó—Ö –ø—Ä–∏–Ω—Ü–∏–ø—ñ–≤)" },
                    { question: "Tu ___ ton calme", options: ["gardes", "fais", "prends"], answer: "gardes", context: "(–¢–∏ –∑–±–µ—Ä—ñ–≥–∞—î—à —Å–ø–æ–∫—ñ–π)" },
                    { question: "Elle ___ sa parole", options: ["tient", "fait", "prend"], answer: "tient", context: "(–í–æ–Ω–∞ —Ç—Ä–∏–º–∞—î —Å–ª–æ–≤–æ)" },
                    { question: "Nous ___ la situation", options: ["ma√Ætrisons", "faisons", "prenons"], answer: "ma√Ætrisons", context: "(–ú–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é—î–º–æ —Å–∏—Ç—É–∞—Ü—ñ—é)" },
                    { question: "Vous ___ vos √©motions", options: ["contr√¥lez", "faites", "prenez"], answer: "contr√¥lez", context: "(–í–∏ –∫–æ–Ω—Ç—Ä–æ–ª—é—î—Ç–µ —Å–≤–æ—ó –µ–º–æ—Ü—ñ—ó)" },
                    { question: "Ils ___ leurs limites", options: ["d√©passent", "font", "prennent"], answer: "d√©passent", context: "(–í–æ–Ω–∏ –ø–µ—Ä–µ–≤–µ—Ä—à—É—é—Ç—å —Å–≤–æ—ó –º–µ–∂—ñ)" },
                    { question: "Je ___ mes habitudes", options: ["change", "fais", "prends"], answer: "change", context: "(–Ø –∑–º—ñ–Ω—é—é —Å–≤–æ—ó –∑–≤–∏—á–∫–∏)" },
                    { question: "Tu ___ tes comp√©tences", options: ["d√©veloppes", "fais", "prends"], answer: "d√©veloppes", context: "(–¢–∏ —Ä–æ–∑–≤–∏–≤–∞—î—à —Å–≤–æ—ó –Ω–∞–≤–∏—á–∫–∏)" },
                    { question: "Elle ___ son exp√©rience", options: ["partage", "fait", "prend"], answer: "partage", context: "(–í–æ–Ω–∞ –¥—ñ–ª–∏—Ç—å—Å—è —Å–≤–æ—ó–º –¥–æ—Å–≤—ñ–¥–æ–º)" },
                    { question: "Nous ___ notre temps", options: ["g√©rons", "faisons", "prenons"], answer: "g√©rons", context: "(–ú–∏ —É–ø—Ä–∞–≤–ª—è—î–º–æ —Å–≤–æ—ó–º —á–∞—Å–æ–º)" },
                    { question: "Vous ___ vos ressources", options: ["optimisez", "faites", "prenez"], answer: "optimisez", context: "(–í–∏ –æ–ø—Ç–∏–º—ñ–∑—É—î—Ç–µ —Å–≤–æ—ó —Ä–µ—Å—É—Ä—Å–∏)" },
                    { question: "Ils ___ leur strat√©gie", options: ["adaptent", "font", "prennent"], answer: "adaptent", context: "(–í–æ–Ω–∏ –∞–¥–∞–ø—Ç—É—é—Ç—å —Å–≤–æ—é —Å—Ç—Ä–∞—Ç–µ–≥—ñ—é)" },
                    { question: "Je ___ mes connaissances", options: ["approfondis", "fais", "prends"], answer: "approfondis", context: "(–Ø –ø–æ–≥–ª–∏–±–ª—é—é —Å–≤–æ—ó –∑–Ω–∞–Ω–Ω—è)" },
                    { question: "Tu ___ ton niveau", options: ["am√©liores", "fais", "prends"], answer: "am√©liores", context: "(–¢–∏ –ø–æ–∫—Ä–∞—â—É—î—à —Å–≤—ñ–π —Ä—ñ–≤–µ–Ω—å)" },
                    { question: "Elle ___ ses objectifs", options: ["poursuit", "fait", "prend"], answer: "poursuit", context: "(–í–æ–Ω–∞ –ø–µ—Ä–µ—Å–ª—ñ–¥—É—î —Å–≤–æ—ó —Ü—ñ–ª—ñ)" },
                    { question: "Nous ___ nos efforts", options: ["concentrons", "faisons", "prenons"], answer: "concentrons", context: "(–ú–∏ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä—É—î–º–æ —Å–≤–æ—ó –∑—É—Å–∏–ª–ª—è)" },
                    { question: "Vous ___ votre avenir", options: ["construisez", "faites", "prenez"], answer: "construisez", context: "(–í–∏ –±—É–¥—É—î—Ç–µ —Å–≤–æ—î –º–∞–π–±—É—Ç–Ω—î)" },
                    { question: "Ils ___ leur destin", options: ["forgent", "font", "prennent"], answer: "forgent", context: "(–í–æ–Ω–∏ –∫—É—é—Ç—å —Å–≤–æ—é –¥–æ–ª—é)" },
                    { question: "Je ___ mes r√™ves", options: ["r√©alise", "fais", "prends"], answer: "r√©alise", context: "(–Ø –∑–¥—ñ–π—Å–Ω—é—é —Å–≤–æ—ó –º—Ä—ñ—ó)" }
                ]
            },
            speed: {
                beginner: [
                    { question: "___ suis", answer: "je" },
                    { question: "tu ___", answer: "es" },
                    { question: "___ a", answer: "il" },
                    { question: "nous ___", answer: "sommes" },
                    { question: "___ avez", answer: "vous" },
                    { question: "ils ___", answer: "sont" },
                    { question: "___ ai", answer: "j" },
                    { question: "elle ___", answer: "a" },
                    { question: "___ vais", answer: "je" },
                    { question: "tu ___", answer: "vas" },
                    { question: "___ va", answer: "il" },
                    { question: "nous ___", answer: "allons" },
                    { question: "___ allez", answer: "vous" },
                    { question: "elles ___", answer: "vont" },
                    { question: "___ fais", answer: "je" },
                    { question: "tu ___", answer: "fais" },
                    { question: "___ fait", answer: "il" },
                    { question: "nous ___", answer: "faisons" },
                    { question: "___ faites", answer: "vous" },
                    { question: "ils ___", answer: "font" },
                    { question: "___ peux", answer: "je" },
                    { question: "tu ___", answer: "peux" },
                    { question: "___ peut", answer: "il" },
                    { question: "nous ___", answer: "pouvons" },
                    { question: "___ pouvez", answer: "vous" },
                    { question: "elles ___", answer: "peuvent" },
                    { question: "___ veux", answer: "je" },
                    { question: "tu ___", answer: "veux" },
                    { question: "___ veut", answer: "il" },
                    { question: "nous ___", answer: "voulons" }
                ],
                intermediate: [
                    { question: "___ prends", answer: "je" },
                    { question: "tu ___", answer: "viens" },
                    { question: "___ sort", answer: "il" },
                    { question: "nous ___", answer: "buvons" },
                    { question: "___ voyez", answer: "vous" },
                    { question: "elles ___", answer: "partent" },
                    { question: "___ lis", answer: "je" },
                    { question: "tu ___", answer: "√©cris" },
                    { question: "___ dort", answer: "il" },
                    { question: "nous ___", answer: "offrons" },
                    { question: "___ mentez", answer: "vous" },
                    { question: "ils ___", answer: "courent" },
                    { question: "___ mets", answer: "je" },
                    { question: "tu ___", answer: "bats" },
                    { question: "___ conna√Æt", answer: "il" },
                    { question: "nous ___", answer: "suivons" },
                    { question: "___ vivez", answer: "vous" },
                    { question: "elles ___", answer: "rient" },
                    { question: "___ comprends", answer: "je" },
                    { question: "tu ___", answer: "attends" },
                    { question: "___ descend", answer: "il" },
                    { question: "nous ___", answer: "r√©pondons" },
                    { question: "___ vendez", answer: "vous" },
                    { question: "ils ___", answer: "entendent" },
                    { question: "___ perds", answer: "je" },
                    { question: "tu ___", answer: "rends" },
                    { question: "___ tend", answer: "il" },
                    { question: "nous ___", answer: "d√©fendons" },
                    { question: "___ apprenez", answer: "vous" },
                    { question: "elles ___", answer: "surprennent" }
                ],
                advanced: [
                    { question: "___ conduis", answer: "je" },
                    { question: "tu ___", answer: "r√©sous" },
                    { question: "___ re√ßoit", answer: "il" },
                    { question: "nous ___", answer: "apercevons" },
                    { question: "___ d√©cevez", answer: "vous" },
                    { question: "ils ___", answer: "craignent" },
                    { question: "___ peins", answer: "je" },
                    { question: "elle ___", answer: "joint" },
                    { question: "nous ___", answer: "cousons" },
                    { question: "___ moulez", answer: "vous" },
                    { question: "ils ___", answer: "absolvent" },
                    { question: "___ me tais", answer: "je" },
                    { question: "tu ___", answer: "extrais" },
                    { question: "___ construit", answer: "il" },
                    { question: "nous ___", answer: "traduisons" },
                    { question: "___ instruisez", answer: "vous" },
                    { question: "elles ___", answer: "d√©truisent" },
                    { question: "___ cuis", answer: "je" },
                    { question: "tu ___", answer: "nuis" },
                    { question: "___ luit", answer: "il" },
                    { question: "nous ___", answer: "nous enfuyons" },
                    { question: "___ accueillez", answer: "vous" },
                    { question: "ils ___", answer: "cueillent" },
                    { question: "___ recueille", answer: "je" },
                    { question: "tu ___", answer: "assailles" },
                    { question: "___ tressaille", answer: "il" },
                    { question: "nous ___", answer: "d√©faillons" },
                    { question: "___ saillez", answer: "vous" },
                    { question: "elles ___", answer: "saillent" },
                    { question: "___ m'assieds", answer: "je" }
                ]
            }
        };

        // Achievement definitions
        const achievements = {
            'first-correct': { name: '–ü–µ—Ä—à–∞ –ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å', condition: () => gameState.totalCorrect >= 1 },
            'streak-5': { name: '–°–µ—Ä—ñ—è –∑ 5 –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö', condition: () => gameState.currentStreak >= 5 },
            'streak-10': { name: '–°–µ—Ä—ñ—è –∑ 10 –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö', condition: () => gameState.currentStreak >= 10 },
            'completed-10': { name: '10 –≤–ø—Ä–∞–≤ –≤–∏–∫–æ–Ω–∞–Ω–æ', condition: () => gameState.totalExercises >= 10 },
            'perfect-score': { name: '–Ü–¥–µ–∞–ª—å–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç', condition: () => false }
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadGameState();
            setupEventListeners();
            generateQuestions();
            updateUI();
            updateReviewTabVisibility();
        });

        function setupEventListeners() {
            // Tab clicks
            document.querySelectorAll('.tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    gameState.currentExercise = this.dataset.exercise;
                    showExercise(this.dataset.exercise);
                    generateQuestions();
                });
            });

            // Difficulty buttons
            document.querySelectorAll('.difficulty-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    gameState.difficulty = this.dataset.difficulty;
                    document.querySelectorAll('.difficulty-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    generateQuestions();
                });
            });

            // Control buttons
            document.getElementById('checkBtn').addEventListener('click', checkAnswers);
            document.getElementById('newQuestionsBtn').addEventListener('click', generateQuestions);
            document.getElementById('resetBtn').addEventListener('click', resetCurrentExercise);
            document.getElementById('nextExerciseBtn').addEventListener('click', nextExercise);
        }

        function showExercise(exerciseId) {
            // Hide all exercises
            document.querySelectorAll('.exercise').forEach(ex => ex.classList.remove('active'));
            
            // Show selected exercise
            document.getElementById(exerciseId).classList.add('active');
            
            // Update tabs
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelector(`[data-exercise="${exerciseId}"]`).classList.add('active');
            
            resetCurrentExercise();
        }

        function generateQuestions() {
            const exercise = gameState.currentExercise;
            const difficulty = gameState.difficulty;
            
            // Special handling for review exercise
            if (exercise === 'review') {
                generateReviewQuestions();
                resetCurrentExercise();
                return;
            }
            
            const data = exerciseData[exercise][difficulty];
            if (!data) return;

            // Track used questions to avoid repetition
            if (!gameState.usedQuestions[exercise]) {
                gameState.usedQuestions[exercise] = {};
            }
            if (!gameState.usedQuestions[exercise][difficulty]) {
                gameState.usedQuestions[exercise][difficulty] = [];
            }

            // Get unused questions
            const usedQuestions = gameState.usedQuestions[exercise][difficulty];
            const availableQuestions = data.filter((_, index) => !usedQuestions.includes(index));
            
            // If all questions have been used, reset the pool
            if (availableQuestions.length < 4) {
                gameState.usedQuestions[exercise][difficulty] = [];
                const resetQuestions = data.filter((_, index) => !gameState.usedQuestions[exercise][difficulty].includes(index));
                gameState.currentQuestions = resetQuestions.slice(0, Math.min(6, data.length));
            } else {
                // Select new questions
                const shuffled = [...availableQuestions].sort(() => Math.random() - 0.5);
                gameState.currentQuestions = shuffled.slice(0, Math.min(6, availableQuestions.length));
            }
            
            // Mark selected questions as used
            gameState.currentQuestions.forEach(question => {
                const originalIndex = data.indexOf(question);
                if (originalIndex !== -1 && !usedQuestions.includes(originalIndex)) {
                    usedQuestions.push(originalIndex);
                }
            });
            
            const container = document.getElementById(exercise + 'Questions');
            container.innerHTML = '';
            
            gameState.currentQuestions.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                questionDiv.innerHTML = generateQuestionHTML(q, index, exercise);
                container.appendChild(questionDiv);
            });

            // Setup sentence building if needed
            if (exercise === 'sentences') {
                setupSentenceBuilding();
            }

            // Setup speed timer if needed
            if (exercise === 'speed') {
                setupSpeedTimer();
            }

            resetCurrentExercise();
        }

        function generateQuestionHTML(question, index, exerciseType) {
            let html = '';

            switch (exerciseType) {
                case 'conjugation':
                case 'negation':
                    html = `
                        ${question.question.replace('___', `<input type="text" id="q${index}" data-answer="${question.answer}" placeholder="...">`)}
                        <div class="result">–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: ${question.answer}</div>
                    `;
                    break;

                case 'questions':
                    html = `
                        ${question.question.replace('___', `<input type="text" id="q${index}" data-answer="${question.answer}" placeholder="..." style="width: 200px;">`)}
                        <div class="result">–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: ${question.answer}</div>
                    `;
                    break;

                case 'sentences':
                    html = `
                        <p><strong>–°–∫–ª–∞–¥—ñ—Ç—å —Ä–µ—á–µ–Ω–Ω—è:</strong> "${question.instruction}"</p>
                        <div class="sentence-builder">
                            ${question.words.map(word => `<span class="word-option" data-word="${word}">${word}</span>`).join('')}
                        </div>
                        <div class="sentence-display" id="sentence${index}"></div>
                        <button type="button" class="btn btn-secondary" onclick="clearSentence(${index})">–û—á–∏—Å—Ç–∏—Ç–∏</button>
                        <div class="result">–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: ${question.answer}</div>
                    `;
                    break;

                case 'context':
                    const options = question.options.map(opt => `<option value="${opt}">${opt}</option>`).join('');
                    html = `
                        ${question.question.replace('___', `<select id="q${index}" data-answer="${question.answer}"><option value="">–í–∏–±–µ—Ä—ñ—Ç—å...</option>${options}</select>`)} ${question.context}
                        <div class="result">–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: ${question.answer}</div>
                    `;
                    break;

                case 'speed':
                    html = `
                        ${question.question.replace('___', `<input type="text" id="q${index}" data-answer="${question.answer}" placeholder="..." style="width: 100px;">`)}
                        <div class="result">–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å: ${question.answer}</div>
                    `;
                    break;
            }

            return html;
        }

        function setupSentenceBuilding() {
            gameState.sentenceBuilders = {};
            
            document.querySelectorAll('.word-option').forEach(option => {
                option.addEventListener('click', function() {
                    if (this.classList.contains('used')) return;
                    
                    const word = this.dataset.word;
                    const questionDiv = this.closest('.question');
                    const questionIndex = Array.from(questionDiv.parentNode.children).indexOf(questionDiv);
                    const sentenceId = `sentence${questionIndex}`;
                    
                    if (!gameState.sentenceBuilders[sentenceId]) {
                        gameState.sentenceBuilders[sentenceId] = [];
                    }
                    
                    gameState.sentenceBuilders[sentenceId].push(word);
                    this.classList.add('used');
                    
                    updateSentenceDisplay(sentenceId);
                });
            });
        }

        function updateSentenceDisplay(sentenceId) {
            const display = document.getElementById(sentenceId);
            if (display && gameState.sentenceBuilders[sentenceId]) {
                display.textContent = gameState.sentenceBuilders[sentenceId].join(' ');
            }
        }

        function clearSentence(questionIndex) {
            const sentenceId = `sentence${questionIndex}`;
            gameState.sentenceBuilders[sentenceId] = [];
            updateSentenceDisplay(sentenceId);
            
            const questionDiv = document.querySelectorAll('.question')[questionIndex];
            questionDiv.querySelectorAll('.word-option').forEach(option => {
                option.classList.remove('used');
            });
        }

        function setupSpeedTimer() {
            gameState.speedTimeLeft = 30;
            const timerDisplay = document.getElementById('speedTimer');
            
            if (gameState.speedTimer) {
                clearInterval(gameState.speedTimer);
            }
            
            gameState.speedTimer = setInterval(() => {
                gameState.speedTimeLeft--;
                timerDisplay.textContent = `‚è±Ô∏è ${gameState.speedTimeLeft}s`;
                
                if (gameState.speedTimeLeft <= 0) {
                    clearInterval(gameState.speedTimer);
                    timerDisplay.textContent = "‚è±Ô∏è –ß–∞—Å –≤–∏–π—à–æ–≤!";
                    checkAnswers();
                }
            }, 1000);
            
            timerDisplay.textContent = `‚è±Ô∏è ${gameState.speedTimeLeft}s`;
        }

        function checkAnswers() {
            let correctCount = 0;
            const totalQuestions = gameState.currentQuestions.length;
            
            gameState.currentQuestions.forEach((q, index) => {
                let userAnswer = '';
                let correctAnswer = q.answer;
                const questionDiv = document.querySelectorAll('.question')[index];
                
                if (gameState.currentExercise === 'sentences') {
                    const sentenceId = `sentence${index}`;
                    userAnswer = gameState.sentenceBuilders[sentenceId] ? gameState.sentenceBuilders[sentenceId].join(' ') : '';
                } else {
                    const input = document.getElementById(`q${index}`);
                    if (input) {
                        userAnswer = input.value || input.selectedOptions?.[0]?.value || '';
                    }
                }
                
                const isCorrect = normalizeAnswer(userAnswer) === normalizeAnswer(correctAnswer);
                
                if (isCorrect) {
                    correctCount++;
                    questionDiv.classList.add('correct');
                    questionDiv.classList.remove('incorrect');
                } else {
                    questionDiv.classList.add('incorrect');
                    questionDiv.classList.remove('correct');
                    const resultDiv = questionDiv.querySelector('.result');
                    if (resultDiv) {
                        resultDiv.style.display = 'block';
                    }
                    
                    // Add to mistake questions for review
                    if (gameState.currentExercise !== 'review') {
                        const mistakeQuestion = {
                            ...q,
                            exerciseType: gameState.currentExercise,
                            userAnswer: userAnswer,
                            timestamp: Date.now()
                        };
                        
                        // Check if this question is already in mistakes (avoid duplicates)
                        const isDuplicate = gameState.mistakeQuestions.some(mistake => 
                            mistake.question === q.question && 
                            mistake.answer === q.answer && 
                            mistake.exerciseType === gameState.currentExercise
                        );
                        
                        if (!isDuplicate) {
                            gameState.mistakeQuestions.push(mistakeQuestion);
                            
                            // Keep only last 50 mistakes to avoid too large storage
                            if (gameState.mistakeQuestions.length > 50) {
                                gameState.mistakeQuestions = gameState.mistakeQuestions.slice(-50);
                            }
                        }
                    }
                }
            });
            
            updateGameState(correctCount, totalQuestions);
            updateUI();
            updateScoreDisplay(correctCount, totalQuestions);
            checkAchievements();
            updateReviewTabVisibility();
            
            if (gameState.speedTimer) {
                clearInterval(gameState.speedTimer);
            }
            
            // Show completion notification
            const percentage = Math.round((correctCount / totalQuestions) * 100);
            if (percentage === 100) {
                showNotification(`–í—ñ–¥–º—ñ–Ω–Ω–æ! –í—Å—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ! üéâ`, 'success');
            } else if (percentage >= 70) {
                showNotification(`–î–æ–±—Ä–µ! ${percentage}% –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π! üëç`, 'success');
            } else {
                showNotification(`${percentage}% –ø—Ä–∞–≤–∏–ª—å–Ω–∏—Ö. –ü—Ä–æ–¥–æ–≤–∂—É–π—Ç–µ –≤—á–∏—Ç–∏—Å—è! üí™`, 'warning');
            }
        }

        function updateGameState(correctCount, totalQuestions) {
            gameState.totalExercises++;
            gameState.totalCorrect += correctCount;
            
            if (correctCount === totalQuestions) {
                gameState.currentStreak++;
            } else {
                gameState.currentStreak = 0;
            }
            
            // Level up logic
            const requiredPoints = gameState.userLevel * 10;
            if (gameState.totalCorrect >= requiredPoints) {
                gameState.userLevel++;
                showNotification(`–†—ñ–≤–µ–Ω—å –ø—ñ–¥–≤–∏—â–µ–Ω–æ! –¢–µ–ø–µ—Ä –≤–∏ ${gameState.userLevel} —Ä—ñ–≤–Ω—è! üéâ`, 'success');
            }
            
            saveGameState();
        }

        function checkAchievements() {
            Object.keys(achievements).forEach(key => {
                if (!gameState.achievements.includes(key)) {
                    if (achievements[key].condition()) {
                        gameState.achievements.push(key);
                        unlockAchievement(key);
                    }
                }
            });
            
            // Check for perfect score
            const currentScore = document.getElementById('scoreDisplay').textContent;
            if (currentScore.includes('100%') || currentScore.split('/')[0] === currentScore.split('/')[1]) {
                if (!gameState.achievements.includes('perfect-score')) {
                    gameState.achievements.push('perfect-score');
                    unlockAchievement('perfect-score');
                }
            }
            
            updateAchievementsDisplay();
        }

        function unlockAchievement(achievementKey) {
            showNotification(`üèÜ –î–æ—Å—è–≥–Ω–µ–Ω–Ω—è —Ä–æ–∑–±–ª–æ–∫–æ–≤–∞–Ω–æ: ${achievements[achievementKey].name}!`, 'success');
        }

        function updateAchievementsDisplay() {
            document.querySelectorAll('.achievement').forEach(achievement => {
                const key = achievement.dataset.achievement;
                if (gameState.achievements.includes(key)) {
                    achievement.classList.remove('locked');
                    achievement.classList.add('unlocked');
                }
            });
        }

        function updateReviewTabVisibility() {
            const reviewTab = document.getElementById('reviewTab');
            const mistakeCount = gameState.mistakeQuestions.length;
            
            if (mistakeCount > 0) {
                reviewTab.style.display = 'block';
                reviewTab.innerHTML = `üîÑ –ü–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫ (${mistakeCount})`;
            } else {
                reviewTab.style.display = 'none';
            }
        }

        function generateReviewQuestions() {
            const container = document.getElementById('reviewQuestions');
            
            if (gameState.mistakeQuestions.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px;">
                        <p style="font-size: 1.2em; color: #667eea;">üìö –¢—É—Ç –∑'—è–≤–ª—è—Ç—å—Å—è –ø–∏—Ç–∞–Ω–Ω—è, –Ω–∞ —è–∫—ñ –≤–∏ –ø–æ–º–∏–ª—è–ª–∏—Å—è</p>
                        <p style="color: #718096;">–°–ø–æ—á–∞—Ç–∫—É –ø—Ä–æ–π–¥—ñ—Ç—å —ñ–Ω—à—ñ –≤–ø—Ä–∞–≤–∏, —â–æ–± –Ω–∞–∫–æ–ø–∏—á–∏—Ç–∏ –ø–æ–º–∏–ª–∫–∏ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–Ω—è</p>
                    </div>
                `;
                return;
            }
            
            // Take up to 6 most recent mistakes
            const recentMistakes = gameState.mistakeQuestions.slice(-6);
            gameState.currentQuestions = recentMistakes;
            
            container.innerHTML = '';
            
            recentMistakes.forEach((q, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question';
                
                let questionHTML = `
                    <div class="review-info">
                        <strong>–¢–∏–ø –≤–ø—Ä–∞–≤–∏:</strong> ${getExerciseDisplayName(q.exerciseType)} | 
                        <strong>–í–∞—à–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—å:</strong> "${q.userAnswer}"
                    </div>
                `;
                
                questionHTML += generateQuestionHTML(q, index, q.exerciseType);
                
                questionDiv.innerHTML = questionHTML;
                container.appendChild(questionDiv);
            });
            
            // Setup sentence building if needed
            if (recentMistakes.some(q => q.exerciseType === 'sentences')) {
                setupSentenceBuilding();
            }
        }

        function getExerciseDisplayName(exerciseType) {
            const names = {
                'conjugation': '–í—ñ–¥–º—ñ–Ω—é–≤–∞–Ω–Ω—è',
                'negation': '–ó–∞–ø–µ—Ä–µ—á–µ–Ω–Ω—è',
                'questions': '–ü–∏—Ç–∞–Ω–Ω—è',
                'sentences': '–°–∫–ª–∞–¥–∞–Ω–Ω—è —Ä–µ—á–µ–Ω—å',
                'context': '–ö–æ–Ω—Ç–µ–∫—Å—Ç',
                'speed': '–®–≤–∏–¥–∫—ñ—Å—Ç—å'
            };
            return names[exerciseType] || exerciseType;
        }

        function normalizeAnswer(answer) {
            return answer.toLowerCase().trim().replace(/['']/g, "'").replace(/\s+/g, ' ');
        }

        function resetCurrentExercise() {
            // Reset all question states
            document.querySelectorAll('.question').forEach(question => {
                question.classList.remove('correct', 'incorrect');
                const result = question.querySelector('.result');
                if (result) result.style.display = 'none';
            });
            
            // Reset inputs
            document.querySelectorAll('input[type="text"]').forEach(input => input.value = '');
            document.querySelectorAll('select').forEach(select => select.value = '');
            
            // Reset sentence builders
            if (gameState.currentExercise === 'sentences') {
                gameState.sentenceBuilders = {};
                document.querySelectorAll('.word-option').forEach(option => {
                    option.classList.remove('used');
                });
                document.querySelectorAll('.sentence-display').forEach(display => {
                    display.textContent = '';
                });
            }
            
            // Reset speed timer
            if (gameState.currentExercise === 'speed') {
                if (gameState.speedTimer) {
                    clearInterval(gameState.speedTimer);
                }
                document.getElementById('speedTimer').textContent = '';
            }
            
            updateScoreDisplay(0, gameState.currentQuestions.length);
        }

        function nextExercise() {
            const exercises = ['conjugation', 'negation', 'questions', 'sentences', 'context', 'speed'];
            const currentIndex = exercises.indexOf(gameState.currentExercise);
            const nextIndex = (currentIndex + 1) % exercises.length;
            
            gameState.currentExercise = exercises[nextIndex];
            showExercise(exercises[nextIndex]);
            generateQuestions();
        }

        function updateUI() {
            // Update stats
            document.getElementById('totalExercises').textContent = gameState.totalExercises;
            document.getElementById('totalCorrect').textContent = gameState.totalCorrect;
            document.getElementById('currentStreak').textContent = gameState.currentStreak;
            document.getElementById('userLevel').textContent = gameState.userLevel;
            
            updateAchievementsDisplay();
        }

        function updateScoreDisplay(correct, total) {
            const percentage = total > 0 ? Math.round((correct / total) * 100) : 0;
            document.getElementById('scoreDisplay').textContent = `${correct}/${total} (${percentage}%)`;
        }

        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type} show`;
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }

        function saveGameState() {
            try {
                localStorage.setItem('frenchLearningState', JSON.stringify(gameState));
            } catch (e) {
                // localStorage not available, continue without saving
            }
        }

        function loadGameState() {
            try {
                const saved = localStorage.getItem('frenchLearningState');
                if (saved) {
                    const parsedState = JSON.parse(saved);
                    gameState = { ...gameState, ...parsedState };
                }
            } catch (e) {
                // localStorage not available or corrupted, use default state
            }
        }

        // Global function for sentence building
        window.clearSentence = clearSentence;
    </script>
</body>
</html>
